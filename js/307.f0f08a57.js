"use strict";(self["webpackChunktravel_web_app"]=self["webpackChunktravel_web_app"]||[]).push([[307],{6295:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(3396),i=l(7139);const s=["title"],o={class:"form-group-title"},r={class:"form-group-input"};function n(e,t,l,n,d,u){return(0,a.wg)(),(0,a.iD)("div",{class:"form-group",title:l.title},[(0,a._)("div",o,(0,i.zw)(l.title),1),(0,a._)("div",r,[(0,a.WI)(e.$slots,"default")])],8,s)}var d={name:"FormGroup",props:{title:{type:String}}},u=l(89);const m=(0,u.Z)(d,[["render",n]]);var c=m},7307:function(e,t,l){l.r(t),l.d(t,{default:function(){return J}});var a=l(3396);const i=["onClick"],s=(0,a._)("span",{class:"modal__title"},"Khu nghỉ dưỡng",-1),o={class:"modal__content"},r={class:"flex-column d-flex flex1"},n={key:0,class:"d-flex mt-2"},d={key:1,class:"d-flex mt-2"},u={class:"d-flex mt-2"},m={class:"d-flex mt-2"},c={class:"article-list w-100"},p={class:"article-detail"},v={class:"article-head"},g={class:"modal__footer pt4 pb4"};function h(e,t,l,h,f,_){const w=(0,a.up)("v-icon"),b=(0,a.up)("b-input"),y=(0,a.up)("image-picker"),k=(0,a.up)("form-group"),$=(0,a.up)("b-autocomplete"),x=(0,a.up)("b-text-area"),V=(0,a.up)("article-detail"),D=(0,a.up)("v-col"),L=(0,a.up)("v-btn"),C=(0,a.up)("vue-final-modal");return(0,a.wg)(),(0,a.j4)(C,(0,a.dG)(e.$attrs,{classes:"modal-container","content-class":"modal-content resort-detail","min-width":200,height:800,modelValue:h.show,"onUpdate:modelValue":t[10]||(t[10]=e=>h.show=e),"click-to-close":!1,name:"ResortDetail",onBeforeOpen:h.beforeOpen}),{default:(0,a.w5)((({close:l})=>[(0,a._)("button",{class:"modal__close",onClick:l},[(0,a.Wm)(w,{icon:"mdi-close"})],8,i),s,(0,a._)("div",o,[(0,a.Wm)(D,{class:"form-col"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{title:"Thông tin chung"},{default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a.Wm)(b,{class:"mt-2",modelValue:h.model.title,"onUpdate:modelValue":t[0]||(t[0]=e=>h.model.title=e),label:"Tên"},null,8,["modelValue"]),(0,a.Wm)(k,{title:"Ảnh minh họa",class:"cover-image mt-2"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{width:400,height:250,images:h.coverImages,"onUpdate:images":t[1]||(t[1]=e=>h.coverImages=e)},null,8,["images"])])),_:1}),(0,a.Wm)($,{class:"mt-2",returnObject:!0,items:h.parentList,"onUpdate:modelValue":[h.chooseParent,t[2]||(t[2]=e=>h.parent=e)],modelValue:h.parent,label:"Thuộc"},null,8,["items","onUpdate:modelValue","modelValue"]),(0,a.Wm)(x,{class:"mt-2",modelValue:h.model.description,"onUpdate:modelValue":t[3]||(t[3]=e=>h.model.description=e),label:"Mô tả"},null,8,["modelValue"]),h.model.type==e.$enums.ResortType.Resort?((0,a.wg)(),(0,a.iD)("div",n,[(0,a.Wm)(b,{class:"mr-2",modelValue:h.model.from_cost,"onUpdate:modelValue":t[4]||(t[4]=e=>h.model.from_cost=e),type:"number",label:"Từ giá"},null,8,["modelValue"]),(0,a.Wm)(b,{class:"ml-2",modelValue:h.model.to_cost,"onUpdate:modelValue":t[5]||(t[5]=e=>h.model.to_cost=e),type:"number",label:"Đến giá"},null,8,["modelValue"])])):((0,a.wg)(),(0,a.iD)("div",d,[(0,a.Wm)(b,{modelValue:h.model.from_cost,"onUpdate:modelValue":t[6]||(t[6]=e=>h.model.from_cost=e),type:"number",label:"Giá"},null,8,["modelValue"])])),(0,a._)("div",u,[(0,a.Wm)($,{class:"flex1",modelValue:h.model.location,"onUpdate:modelValue":t[7]||(t[7]=e=>h.model.location=e),items:h.locations.map((e=>e.location_name)),label:"Tỉnh/thành phố"},null,8,["modelValue","items"])]),(0,a._)("div",m,[(0,a.Wm)(b,{class:"flex1",modelValue:h.model.address,"onUpdate:modelValue":t[8]||(t[8]=e=>h.model.address=e),label:"Địa chỉ"},null,8,["modelValue"])])])])),_:1}),(0,a.Wm)(k,{title:"Danh mục hình ảnh"},{default:(0,a.w5)((()=>[(0,a._)("div",c,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.articles.filter((t=>t.state!=e.$enums.ModelState.Delete)),((e,t)=>((0,a.wg)(),(0,a.j4)(V,{value:e,onAdd:()=>h.addArticle(t,h.articles),onDel:()=>h.delArticle(t,h.articles),key:e.article_id,class:"mb-4"},null,8,["value","onAdd","onDel"])))),128)),(0,a._)("div",p,[(0,a._)("div",v,[(0,a.Wm)(w,{onClick:t[9]||(t[9]=e=>h.addArticle(h.articles.length,h.articles)),icon:"mdi-plus"})])])])])),_:1})])),_:1})]),(0,a._)("div",g,[(0,a.Wm)(L,{onClick:l,class:"modal_footer-btn"},{default:(0,a.w5)((()=>[(0,a.Uk)("Hủy")])),_:2},1032,["onClick"]),(0,a.Wm)(L,{onClick:h.save,color:"primary",class:"modal_footer-btn ml8"},{default:(0,a.w5)((()=>[(0,a.Uk)("Lưu")])),_:1},8,["onClick"])])])),_:1},16,["modelValue","onBeforeOpen"])}l(7658);var f=l(4870),_=l(6295),w=l(7139);const b=["multiple"],y=(0,a.uE)('<svg xmlns="http://www.w3.org/2000/svg" width="62" height="62" fill="none" viewBox="0 0 62 62"><path fill="#1B2F51" fill-opacity=".3" fill-rule="evenodd" d="M42.625 17.438v27.331c0 5.4-3.953 10.204-9.326 10.721-6.174.594-11.341-4.237-11.341-10.282v-31.93c0-3.384 2.428-6.458 5.787-6.794a6.459 6.459 0 017.13 6.433v27.125a2.59 2.59 0 01-2.584 2.583 2.59 2.59 0 01-2.583-2.583V17.437c0-1.059-.878-1.937-1.938-1.937-1.059 0-1.937.878-1.937 1.938V39.68c0 3.384 2.428 6.458 5.787 6.794a6.459 6.459 0 007.13-6.432V13.356c0-5.4-3.953-10.204-9.326-10.721-6.148-.594-11.341 4.237-11.341 10.282v31.697c0 7.414 5.425 14.053 12.813 14.751 8.5.775 15.604-5.838 15.604-14.157v-27.77c0-1.06-.879-1.938-1.938-1.938s-1.937.878-1.937 1.938z" clip-rule="evenodd"></path></svg><div class="my-3">Upload your images</div><div class="text-xs opacity-40">JPG, PNG and less than 2MB</div><div> Drag and drop or <span class="text-info underline">select</span> your project images here </div>',4),k=["src","height","width"],$=["onClick"],x=["width","height"],V=(0,a._)("circle",{cx:"30",cy:"30",r:"28.5",fill:"#fff",stroke:"#2775F9","stroke-width":"3"},null,-1),D=(0,a._)("path",{fill:"#2775F8",d:"M20.184 32.285V29.16h8.125v-8.223h3.066v8.223H39.5v3.125h-8.125v8.3h-3.066v-8.3h-8.125z"},null,-1),L=[V,D];function C(e,t){const l=(0,a.up)("v-icon");return(0,a.wg)(),(0,a.iD)("div",{class:(0,w.C_)({"flex flex-col w-full mt-2 flex-shrink-0 border rounded bg-light":!e.customWrap,"border border-[#F55646]":e.error}),onDragover:t[3]||(t[3]=(...t)=>e.dragover&&e.dragover(...t)),onDragleave:t[4]||(t[4]=(...t)=>e.dragleave&&e.dragleave(...t)),onDrop:t[5]||(t[5]=(...t)=>e.drop&&e.drop(...t))},[(0,a._)("input",{id:"assetsFieldHandle",ref:"imagesList",type:"file",multiple:e.multiple,class:"w-px h-px opacity-0 overflow-hidden absolute",accept:".pdf,.jpg,.jpeg,.png",onChange:t[0]||(t[0]=(...t)=>e.onChange&&e.onChange(...t))},null,40,b),e.imagesList.filter((t=>t.state!=e.$enums.ModelState.Delete)).length?((0,a.wg)(),(0,a.iD)("div",{key:1,class:(0,w.C_)(["d-flex flex-row flex-wrap w-full max-h-full",{"py-10 px-6 gap-4 items-start justify-start":e.multiple,"items-center justify-center":!e.multiple}])},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.imagesList.filter((t=>t.state!=e.$enums.ModelState.Delete)),((t,i)=>((0,a.wg)(),(0,a.iD)("div",{key:i,class:(0,w.C_)(["relative overflow-hidden rounded-lg",e.multiple?"w-[200px] h-[200px]":"w-full h-full"]),onClick:e=>!1},[(0,a._)("img",{src:t.src,alt:"",class:"w-full h-full object-cover",height:e.height,width:e.width},null,8,k),(0,a._)("button",{class:"absolute flex items-center justify-center top-2 right-2 w-[40px] h-[40px] bg-info rounded pointer",type:"button",title:"Remove file",onClick:l=>e.remove(e.imagesList.indexOf(t))},[(0,a.Wm)(l,{icon:"mdi-delete-outline"})],8,$)],2)))),128)),e.multiple?((0,a.wg)(),(0,a.iD)("label",{key:0,onClick:t[2]||(t[2]=t=>e.$refs.imagesList.click()),class:"relative flex items-center justify-center bg-white border border-dashed overflow-hidden w-[200px] h-[200px] rounded-lg cursor-pointer"},[((0,a.wg)(),(0,a.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.width,height:e.height,fill:"none",viewBox:"0 0 60 60"},L,8,x))])):(0,a.kq)("",!0)],2)):((0,a.wg)(),(0,a.iD)("label",{key:0,onClick:t[1]||(t[1]=t=>e.$refs.imagesList.click()),class:"flex flex-col w-full py-10 px-6 items-center justify-center cursor-pointer"},[(0,a.WI)(e.$slots,"label",{},(()=>[y]))]))],34)}var M=(0,a.aZ)({name:"ImagePicker",props:{images:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},customWrap:{type:Boolean,default:!1},height:{default:null},width:{default:null}},emits:["update:images"],data(){return{error:""}},computed:{imagesList:{get(){return this.images},set(e){this.$emit("update:images",e)}}},methods:{onChange(){const e=this.$refs.imagesList,t=[...e.files];this.imagesList.length?this.imagesList.push(...t.map((e=>(e.src=URL.createObjectURL(e),e.image_id=this.$uuid.v1(),e.state=this.$enums.ModelState.Add,e.file_name=`${e.name}`,e)))):this.imagesList=t.map((e=>(e.src=URL.createObjectURL(e),e.image_id=this.$uuid.v1(),e.state=this.$enums.ModelState.Add,e.file_name=`${e.name}`,e)))},remove(e){let t=this.imagesList[e];t.state==this.$enums.ModelState.Add?this.imagesList.splice(e,1):t.state=this.$enums.ModelState.Delete},dragover(e){e.preventDefault(),e.currentTarget.classList.contains("bg-green-300")||(e.currentTarget.classList.remove("bg-gray-100"),e.currentTarget.classList.add("bg-green-300"))},dragleave(e){e.currentTarget.classList.add("bg-gray-100"),e.currentTarget.classList.remove("bg-green-300")},drop(e){e.preventDefault(),!this.multiple&&(this.imagesList.length>=1||e.dataTransfer.files.length>1)?this.error="Can't drop more then 1 file":(this.$refs.imagesList.files=e.dataTransfer.files,this.onChange()),e.currentTarget.classList.add("bg-gray-100"),e.currentTarget.classList.remove("bg-green-300")}}}),A=l(89);const W=(0,A.Z)(M,[["render",C]]);var S=W;const U={class:"article-detail"},T={class:"article-head"},Z={class:"article-content"},j={class:"article-title"},F={key:0,class:"article-images"};function R(e,t,l,i,s,o){const r=(0,a.up)("v-icon"),n=(0,a.up)("b-input"),d=(0,a.up)("image-picker");return(0,a.wg)(),(0,a.iD)("div",U,[(0,a._)("div",T,[(0,a.Wm)(r,{onClick:i.add,icon:"mdi-plus"},null,8,["onClick"]),(0,a.Wm)(r,{onClick:i.del,icon:"mdi-close"},null,8,["onClick"])]),(0,a._)("div",Z,[(0,a._)("div",j,[(0,a.Wm)(n,{onInput:i.changeData,modelValue:i.modelValue.title,"onUpdate:modelValue":t[0]||(t[0]=e=>i.modelValue.title=e),label:"Tiêu đề"},null,8,["onInput","modelValue"])]),i.modelValue.images?((0,a.wg)(),(0,a.iD)("div",F,[(0,a.Wm)(d,{class:"article-images-picker",multiple:"",width:160,height:160,images:i.modelValue.images,"onUpdate:images":t[1]||(t[1]=e=>i.modelValue.images=e)},null,8,["images"])])):(0,a.kq)("",!0)])])}var H={name:"ArticleDetail",props:{value:{default:()=>{}}},components:{ImagePicker:S},setup(){const{proxy:e}=(0,a.FN)(),t=(0,a.Fl)({get(){return e.value},set(t){t.state!=e.$enums.ModelState.Add&&(t.state=e.$enums.ModelState.Edit),e.$emit("update:modelValue",t)}}),l=()=>{t.value.state!=e.$enums.ModelState.Add&&(t.value.state=e.$enums.ModelState.Edit)},i=()=>{e.$emit("add")},s=()=>{e.$emit("del")};return{modelValue:t,add:i,del:s,changeData:l}}};const I=(0,A.Z)(H,[["render",R]]);var B=I,O=l(1133),P=l(5753),G=l(5244);const E=(e,t)=>{t=t||"",t&&"/"!=t[t.length-1]&&(t+="/"),t=t.replaceAll("/","%2F");let l=`https://firebasestorage.googleapis.com/v0/b/travel-web-app-6fd3b.appspot.com/o/images%2F${t}${e}?alt=media`;return l};var z=l(570);class K extends z.Z{constructor(){super(),this.api="/api/locations/"}}var N=new K,q={name:"ResortDetail",inheritAttrs:!1,components:{FormGroup:_.Z,ImagePicker:S,ArticleDetail:B,BTextArea:P.Z,BAutocomplete:G.Z},setup(){const{proxy:e}=(0,a.FN)(),t=(0,f.iH)(!0),l=(0,f.iH)({}),i=(0,f.iH)(),s=(0,f.iH)(),o=(0,f.iH)([]),r=(0,f.iH)([]),n=(0,f.iH)([]),d=(0,a.Fl)({get(){return{value:l.value.parent_id||"",title:l.value.parent_name||""}},set(e){l.value.parent_id=e.value,l.value.parent_name=e.title}}),u=t=>{l.value={...t.ref.params.value.data},i.value=t.ref.params.value.mode,s.value=t.ref.params.value,N.get().then((e=>{n.value=e.data})),i.value==e.$enums.ModelState.Edit&&O.Z.getById(l.value.resort_id).then((e=>{l.value=e.data,l.value.from_cost=parseInt(l.value.from_cost||0),l.value.to_cost=parseInt(l.value.to_cost||0),l.value.articles&&l.value.articles.length&&(h.value=l.value.articles),l.value.image&&r.value.push({src:l.value.image})})),O.Z.list({Condition:{parent_id:null}}).then((e=>{o.value=e.data.filter((e=>e.resort_id!=l.value.resort_id)).map((e=>({title:e.title,value:e.resort_id,...e})))}))};(0,a.bv)((()=>{window._detail=e,console.log("ResortDetail")}));const m=(t,a)=>{a.splice(t,0,{article_id:e.$uuid.v1(),resort_id:l.value.resort_id,state:e.$enums.ModelState.Add,images:[]})},c=(t,l)=>{if(t>-1){let a=l[t];a.state==e.$enums.ModelState.Add?l.splice(t,1):a.state=e.$enums.ModelState.Delete}},p=()=>{let t=[];for(const l of h.value)t=t.concat(l.images.filter((t=>t.state==e.$enums.ModelState.Add)).map((e=>(e.article_id=l.article_id,e))));r.value.length&&(t=t.concat(r.value.filter((t=>t.state==e.$enums.ModelState.Add)))),t.length&&O.Z.uploadFile(t,{destination:`${l.value.resort_id}`})},v=t=>{let a=o.value.find((e=>e.resort_id==t.value));a?(l.value.phone=a.phone,l.value.email=a.email,l.value.province_name=a.province_name,l.value.district_name=a.district_name,l.value.type=e.$enums.ResortType.Room):l.value.type=e.$enums.ResortType.Resort},g=async()=>{let a={};l.value.articles=h.value;let i=e.$uuid.v1(),s=r.value.filter((t=>t.state==e.$enums.ModelState.Add));switch(s.length&&s[0].state==e.$enums.ModelState.Add&&(l.value.image=E(s[0].file_name,l.value.resort_id||i)),e.mode){case e.$enums.ModelState.Add:l.value.resort_id||(l.value.resort_id=i),a=await O.Z.post({Model:l.value});break;case e.$enums.ModelState.Edit:a=await O.Z.put({Model:l.value,Condition:{resort_id:l.value.resort_id}});break}a.data&&(p(),"function"==typeof e.params.afterSave&&e.params.afterSave(),e.$toast.success("Lưu dữ liệu thành công"),t.value=!1)},h=(0,f.iH)([]);return{show:t,mode:i,save:g,params:s,beforeOpen:u,model:l,articles:h,delArticle:c,addArticle:m,parentList:o,parent:d,coverImages:r,chooseParent:v,locations:n}}};const Y=(0,A.Z)(q,[["render",h]]);var J=Y}}]);
//# sourceMappingURL=307.f0f08a57.js.map